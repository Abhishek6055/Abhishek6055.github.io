---
title: "Transaction Prediction"
date: 2020-01-28
tags: [Power bi ,Python ]
header:
  image: "/images/new.jpg"
excerpt: "Transaction Prediction - EDA and Feature Engineering"
---
# Introduction.
{: .text-center}
In this project, A company wants to help them identify which customers will make a specific transaction in the future, irrespective of the amount of money transacted. The data provided for this project has the same structure as the real data they have available to solve this problem.
The data is anonimyzed, each row containing 200 numerical values identified just with a number.
In the following we will explore the data, prepare it for a model, train a model and predict the target value for the test set, then prepare a submission.

# Prepare for Data Analysis.
{: .text-center}

## Load Packages and Load data

<img src="{{ site.url }}{{ site.baseurl }}//images/1.jpg" alt="description">

# Data Exploration

## Check the Data
Let's Check the test and train data.

<img src="{{ site.url }}{{ site.baseurl }}//images/2.jpg" alt="description">

Both train and test data have 200,000 entries and 202, respectivelly 201 columns.

Let's glimpse train and test dataset.

<img src="{{ site.url }}{{ site.baseurl }}//images/3.jpg" alt="description">

Basic Details
<img src="{{ site.url }}{{ site.baseurl }}//images/4.jpg" alt="description">

<img src="{{ site.url }}{{ site.baseurl }}//images/5.jpg" alt="description">

Train contains:

* ID_code (string);
* target;
* 200 numerical variables, named from var_0 to var_199;

Test contains:

* ID_code (string);
* 200 numerical variables, named from var_0 to var_199;
* Let's check if there are any missing data. We will also check the type of data.

We check first train.

<img src="{{ site.url }}{{ site.baseurl }}//images/6.jpg" alt="description">

Here we check test dataset.

<img src="{{ site.url }}{{ site.baseurl }}//images/7.jpg" alt="description">

**There are no missing data in train and test datasets. Let's check the numerical values in train and test dataset.**

Describe the Train Data

<img src="{{ site.url }}{{ site.baseurl }}//images/8.jpg" alt="description">

We can make few observations here:

* standard deviation is relatively large for both train and test variable data;
* min, max, mean, sdt values for train and test data looks quite close;
* mean values are distributed over a large range.

The number of values in train and test set is the same. Let's plot the scatter plot for train and test set for few of the features.

We will show just 5% of the data. On x axis we show train values and on the y axis we show the test values.

<img src="{{ site.url }}{{ site.baseurl }}//images/9.jpg" alt="description">

Let's check the distribution of **target** value in train dataset.

<img src="{{ site.url }}{{ site.baseurl }}//images/10.jpg" alt="description">

**There are 10.049% target values with 1**
The data is unbalanced with respect with target value.

## Density plots of features.
{: .text-center}
Let's show now the density plot of variables in train dataset.

We represent with different colors the distribution for values with target value 0 and 1.

```python
t0 = train_df.loc[train_df['target'] == 0]
t1 = train_df.loc[train_df['target'] == 1]
features = train_df.columns.values[2:102]
plot_feature_distribution(t0, t1, '0', '1', features)
```
